angular.module("multiSelect").directive("multiSelect",function(){return{restrict:"E",scope:{model:"=msModel",Change:"=msChange",options:"=msOptions",settings:"@settings"},templateUrl:"multi-select-tpl.html",link:function(e,t,n){e.model&&Array.isArray(e.model)||(e.model=[]),e.showOptions=!1,e.Display=function(e){return e},e.Add=function(t){t&&(e.action=!0,e.model.push(t),e.search="",e.Change({event:"add",value:t}))},e.Remove=function(t,n){e.model.splice(e.model.indexOf(t),1),e.Change({event:"remove",value:t}),n&&n.stopPropagation()},e.Show=function(t){return e.model.indexOf(t)<0},e.FocusSearch=function(){t[0].getElementsByClassName("ms-search")[0].focus(),e.ShowOptions(!0)},e.ShowOptions=function(t){null==t?!e.showOptions:t,e.showOptions=t,e.selected=0},e.HideOptions=function(){return e.action?(e.FocusSearch(),void(e.action=!1)):void(e.showOptions=!1)},e.Select=function(t){e.selected=t},e.Key=function(t){if(t.key)switch(t.key){case"Enter":if(e.shown.length<0)break;e.Add(e.shown[e.selected]),e.selected=0,e.action=!1;break;case"ArrowDown":e.selected++,e.selected%=e.shown.length;break;case"ArrowUp":e.selected--,e.selected+=e.shown.length,e.selected%=e.shown.length;break;case"Backspace":e.search||e.Remove(e.model[e.model.length-1])}}}}});